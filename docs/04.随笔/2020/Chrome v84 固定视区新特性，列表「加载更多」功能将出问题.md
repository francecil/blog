---
title: Chrome v84 å›ºå®šè§†åŒºæ–°ç‰¹æ€§ï¼Œåˆ—è¡¨ã€ŒåŠ è½½æ›´å¤šã€åŠŸèƒ½å°†å‡ºé—®é¢˜
date: 2020-08-03 10:12:40
tags: 
  - Chromium
  - HTML
permalink: /pages/04ff1c/
categories: 
  - éšç¬”
---

## èƒŒæ™¯

æˆ‘ä»¬çš„ç½‘ç«™æœ‰ä¸ªã€Œç‚¹å‡»åŠ è½½æ›´å¤šã€çš„åŠŸèƒ½ï¼Œå°±åƒè¿™æ ·

![](https://sf1-dycdn-tos.pstatp.com/obj/eden-cn/nupohneh7nupehpqnulog/img/loadmore_common.gif)

> ç‚¹å‡»æŒ‰é’®ï¼Œæ‹‰å–æ•°æ®å¡«å……åˆ—è¡¨ï¼Œç”¨æˆ·è‡ªè¡Œæ»šåŠ¨åˆ°ä¸‹æ–¹ï¼Œç»§ç»­ç‚¹å‡»åŠ è½½æ›´å¤šâ€¦â€¦

è¿™ç§åœºæ™¯æ˜¯ä¸æ˜¯å¾ˆå¸¸è§ï¼Ÿï¼Ÿæˆ‘æµè§ˆäº†å‡ ä¸ªç½‘ç«™ï¼Œéƒ½æœ‰è¿™ç§åœºæ™¯ï¼Œå›½å†…æœ€æµè¡Œçš„ Ant Design ç»„ä»¶åº“æ›´æ˜¯ç›´æ¥å°è£…äº†[è¿™ä¸ªåŠŸèƒ½](https://ant.design/components/list-cn/#components-list-demo-loadmore)

<!--more-->

## æœ¬æ¥åªæ˜¯æ²¡å•¥é—®é¢˜çš„ï¼Œç›´åˆ° Chrome V84 çš„å‡ºç°â€¦

> ç¡®åˆ‡çš„è¯´ï¼Œæ˜¯ chromium 84 å‡ºäº†é—®é¢˜ï¼Œå› ä¸ºæœ€æ–°çš„ edge ç”¨çš„ chromium å†…æ ¸ï¼Œä¹Ÿå‡ºäº†ç›¸åŒçš„é—®é¢˜


æœ‰ä¸€å¤©ï¼Œæ”¶åˆ°ç”¨æˆ·åé¦ˆï¼šåœ¨ç‚¹å‡»åŠ è½½æ›´å¤šåï¼Œåˆ—è¡¨å†…å®¹åƒæ˜¯åŸåœ°åˆ·æ–°ï¼Œä½“éªŒå®åœ¨ä¸åœ¨ï¼Œå°±åƒè¿™æ ·

![](https://sf1-dycdn-tos.pstatp.com/obj/eden-cn/nupohneh7nupehpqnulog/img/loadmore.gif)

[åœ¨çº¿ä½“éªŒé“¾æ¥,éœ€è¦ Chrome 84 å“¦>](https://usb6m.csb.app/)

> ç‚¹å‡»åŠ è½½æ›´å¤šï¼ŒæŒ‰é’®ä½ç½®å§‹ç»ˆä¸å˜ï¼Œåˆ—è¡¨å¡«å……åè‡ªè¡Œå‘ä¸Šæ»šåŠ¨ ğŸ˜µ

çœ‹è¿™ä¸ª gif ä½ å¯èƒ½è§‰å¾—è¿˜è¡Œï¼ŒçœŸå®åœºæ™¯æ˜¯ä¼šåŠ è½½æ›´å¤šå†…å®¹çš„ï¼Œè¿™ç§è‡ªè¡Œæ»šåŠ¨ä¼šè®©ç”¨æˆ·çªç„¶æ‰¾ä¸åˆ°åˆšåˆšæµè§ˆé¡¹çš„ä½ç½®ï¼Œæå¤§ç ´åç”¨æˆ·ä½“éªŒã€‚

æˆ–è€…è¯´ï¼Œè¿™ç§åšæ³•æœ‰ä¸€å®šåœºæ™¯ï¼Œä½†æ˜¯è¡Œä¸ºæ§åˆ¶åº”è¯¥äº¤ç»™å‰ç«¯å¼€å‘è€…æ¥å®šä¸æ˜¯ï¼Ÿ

ï¼ˆåºŸè¯å¥½åƒæœ‰ç‚¹å¤šï¼Œæƒ³çœ‹è§£å†³æ–¹æ¡ˆçš„ç›´æ¥æ‹‰åˆ°æ–‡æœ«~

## æ€ä¹ˆå‘ç°æ˜¯ chromium çš„ bug/feature ?

æ”¶åˆ°çš„åé¦ˆï¼Œè¯´çš„æ˜¯å¶ç°ï¼Œç„¶åéƒ¨åˆ†ç”¨æˆ·é«˜é¢‘å‡ºç°ã€‚æ‰€ä»¥æˆ‘ä¸€å¼€å§‹å¹¶æ²¡æœ‰å¾€æµè§ˆå™¨å±‚é¢æƒ³ï¼Œè€Œæ˜¯è‡ªå·±çš„ä»£ç æœ‰æ²¡æœ‰é€»è¾‘æ¼æ´ã€‚

åœ¨å‡ ä¸ªæµè§ˆå™¨ä¸Šè·‘äº†ä¸€éï¼Œå‘ç°ç¡®å®æœ‰äº›æµè§ˆå™¨èƒ½å¤ç°ã€‚åœ¨ç¡®è®¤è‡ªå·±ä»£ç å¤©è¡£æ— ç¼ä¹‹åï¼Œæˆ‘æ€€ç–‘èµ·äº† react ğŸ¤£

ä¸ºäº†éªŒè¯å’Œæ¡†æ¶æ— å…³ï¼Œæˆ‘å…³é—­äº† JavaScript ï¼Œæ‰‹åŠ¨å¤åˆ¶åˆ—è¡¨å…ƒç´ åˆ°çˆ¶èŠ‚ç‚¹ï¼Œè¿˜æ˜¯èƒ½å¤Ÿç¨³å®šå¤ç°ã€‚ã€‚ä¸ºäº†ä¸¥è°¨ï¼Œè‡ªå·±åˆç”¨åŸç”Ÿä»£ç å†™äº†ä¸€ä¸ª [demo](https://codesandbox.io/s/elegant-poincare-usb6m) ï¼Œè¿˜æ˜¯èƒ½å¤Ÿå¤ç°ã€‚é‚£ä¹ˆé—®é¢˜å°±å‡ºåœ¨è¿™äº›æµè§ˆå™¨èº«ä¸Šäº†ã€‚ã€‚

è¿™ä¸€æ™šæåˆ°äº† 11 ç‚¹å¤šï¼Œå…ˆå›å»ç¡ä¸ªè§‰ã€‚ã€‚

ç¬¬äºŒå¤©é†’æ¥ï¼Œè„‘å­æ¸…é†’å¤šäº†ã€‚

å…ˆç¡®å®šå¤ç°æµè§ˆå™¨çš„ç‰ˆæœ¬ï¼ŒåŒäº‹è£…çš„ Chrome 83 æ²¡é—®é¢˜ï¼Œè€Œè‡ªå·±çš„ 84 å‡ºäº†é—®é¢˜ï¼Œçœ‹æ¥æ˜¯è¿™æ¬¡ Chrome æ›´æ–°çš„é”…ã€‚


æ¥ç€å»ç½‘ç»œä¸Šæœæœæœ‰æ²¡æœ‰äººé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ã€‚æ°å¥½ï¼Œå‰ä¸€å¤©ä¹Ÿæœ‰ä¸ªç½‘å‹é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œè§ [ç»™ä½ ä»£ç ï¼šchrome84è¿½åŠ å…ƒç´ çš„é—®é¢˜](https://baijiahao.baidu.com/s?id=1673335174799894188&wfr=spider&for=pc&isFailFlag=1)


æœ€åå»çœ‹ä¸‹æ›´æ–°æ–‡æ¡£ï¼ˆåœ¨æ­¤ä¹‹å‰æˆ‘åªçŸ¥é“ Chrome 84 è°ƒæ•´äº† same-site ç­–ç•¥

åœ¨ [Chrome 84 æ–°ç‰¹æ€§](https://www.chromestatus.com/features#milestone%3D84) æ–‡ä¸­ï¼Œå¹¶æ²¡æœ‰æåˆ°è¿™ä¸ªåŠŸèƒ½ã€‚

çœ‹æ¥å¯¹äºå®˜æ–¹æ¥è¯´ï¼Œè¿™ç§åŠŸèƒ½æ”¹åŠ¨æ˜¯å¾ˆå°çš„ï¼Œä¸è¶³ä»¥æ”¾åˆ° feature åˆ—è¡¨ä¸­ ğŸ™‚ï¼Œæ›´å¤šç»†èŠ‚æç¤ºéœ€è¦åˆ° commit log é‡ŒæŸ¥çœ‹ 

çœ‹æ¥åªèƒ½å»[ç‰ˆæœ¬æäº¤æ—¥å¿—](https://chromium.googlesource.com/chromium/src/+log/83.0.4103.116..84.0.4147.89?pretty=fuller&n=20000)é‡ŒæŸ¥ä¸‹äº†ï¼Œåœ¨è¾“å…¥äº† scroll å…³é”®å­—åï¼Œè·³å‡ºæ¥çš„ç»“æœæœ‰æ•°åƒæ¡ï¼Œç€å®åŠé€€ï¼Œæˆ‘è¿˜æ˜¯å»æ [bug](https://bugs.chromium.org/p/chromium/issues/detail?id=1112040) ç­‰å¾…å®˜æ–¹è§£ç­”å§ã€‚

## å½±å“èŒƒå›´

ç›®å‰ä½¿ç”¨ chromium 84 å†…æ ¸çš„æµè§ˆå™¨éƒ½å—åˆ°äº†å½±å“ï¼ŒåŒ…æ‹¬ï¼š

1. Chrome 84
2. Edge 84
3. Android Chrome 84
4. Android Webview (é»˜è®¤è·Ÿéšæœ¬åœ° Chrome å‡çº§è€Œå‡çº§ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹ç»´æŠ¤ç‰ˆæœ¬)

å•¥ï¼Œæ²¡æœ‰ iOS ? å› ä¸º iOS çš„ Chrome ç”¨çš„ä¸æ˜¯ chromium å†…æ ¸ ğŸ˜€

## æ»šåŠ¨åç§»é‡ç½®çš„è§£å†³æ–¹æ¡ˆ

æ—¢ç„¶æµè§ˆå™¨åšäº†æ»šåŠ¨ï¼Œé‚£æˆ‘ä»¬ã€Œè®°ä½ä¸Šæ¬¡æ»šåŠ¨ä½ç½®ï¼ŒåŠ è½½å®Œåæ»šå›å»ã€ä¸å°±è¡Œäº†ï¼Ÿ

è¯•äº†ä¸€ä¸‹ï¼Œè¿˜çœŸçš„æœ‰æ•ˆã€‚

å®Œæ•´ä»£ç ï¼š

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .items {
            width: 100%;
        }

        .item {
            margin-top: 10px;
            height: 100px;
            width: 100%;
            background-color: #FF142B;
        }

        .btn {
            width: 200px;
            height: 44px;
            margin-bottom: 40px;
            background: #BCCFFF;
            box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 22px;
            font-size: 15px;
            font-weight: 500;
            color: #FF142B;
            -webkit-transition: 150ms all;
            transition: 150ms all;
        }
    </style>
    <script>
        function genRandomColor() {
            const fn = () => parseInt(Math.random() * (255 + 1), 10)
            return `rgb(${fn()},${fn()},${fn()})`
        }
        function showMore() {
            let items = document.querySelector('.items')
            let tmp = document.createElement('div')
            // è®°ä½å½“å‰ä½ç½®
            const currentScrollTop = document.documentElement.scrollTop || document.body.scrollTop
            
            tmp.className = "item"
            tmp.style = `background-color: ${genRandomColor()}`;
            items.appendChild(tmp)
            // æ»šå›åˆ°ä¹‹å‰ä½ç½®
            window.scrollTo({
                top: currentScrollTop
            })
        }
        function showMoreWithTimeout(){
            setTimeout(showMore,10)
        }
    </script>
</head>

<body>
    <div class="container">
        <div class="items">
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </div>
        <button class="btn" onclick="showMore()">ç‚¹å‡»å±•å¼€æ›´å¤š</button>
    </div>
    
</body>

</html>
```

è™½ç„¶å¯ä»¥äº†ï¼Œä½†è¿˜æ˜¯ä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªç–‘é—®ï¼š
1. Chrome 84 å†…éƒ¨æ»šåŠ¨çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Ÿ
2. ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­å¤šæ¬¡æ‰§è¡Œ scrollTo ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ
3. å·²ç»æ‰§è¡Œäº† scrollTo ï¼Œåœ¨ setTimeout é‡Œæ‰§è¡Œ scrollTo å’Œåœ¨ rAF é‡Œæ‰§è¡Œ scrollTo ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
4. scrollTo å’Œ scrollBy åŒæ—¶æ‰§è¡Œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ

é—®é¢˜ 1 æ¯”è¾ƒå¤æ‚ï¼Œå…ˆçœ‹å…¶ä»–å‡ ä¸ªé—®é¢˜

### å¤šæ¬¡æ‰§è¡Œ scrollTo

```js
window.addEventListener("scroll",()=>{console.log("scroll")})
window.scrollTo(0,50) 
console.log(document.documentElement.scrollTop) // 50
window.scrollTo(0,150) 
console.log(document.documentElement.scrollTop) // 150

// è¾“å‡ºä¸€æ¬¡ scroll
```

```js
window.scrollTo(0,50) 
window.requestAnimationFrame(()=>{
    window.scrollTo(0,150) 
})

// è¾“å‡ºä¸¤æ¬¡ scroll
```

ç”±ä»¥ä¸Šä¾‹å­å¯ä»¥çœ‹å‡ºï¼š
- æ¯æ¬¡è¿›è¡Œ scrollTo ï¼Œè¯»å– scrollTop èƒ½å¤Ÿå®æ—¶ååº”
- è§¦å‘ scroll äº‹ä»¶ä¹‹å‰ï¼Œæ— è®ºæ‰§è¡Œäº†å¤šå°‘æ¬¡ scrollTo ï¼Œæœ€åä¹Ÿä»…æ‰§è¡Œä¸€æ¬¡ scroll äº‹ä»¶ï¼Œå¹¶ä»¥æœ€åçš„ scrollTop ä½ç½®ä¸ºå‡†
- åœ¨ rAF é‡Œæ‰§è¡Œ scrollTo ï¼Œè¿˜èƒ½å†æ¬¡è§¦å‘ scroll äº‹ä»¶

ä»¥ä¸Šç»“è®ºä¹Ÿå¯ä»¥ä» HTML è§„èŒƒçš„[äº‹ä»¶å¾ªç¯æè¿°](https://html.spec.whatwg.org/multipage/webappapis.html#update-the-rendering)å¾—çŸ¥ã€‚åœ¨ä¸€æ¬¡äº‹ä»¶å¾ªç¯ä¸­ï¼Œæ‰§è¡Œæ»šåŠ¨æ­¥éª¤ï¼ˆè§¦å‘ scroll äº‹ä»¶ï¼‰ æ˜¯å‘ç”Ÿåœ¨ rAF ä¹‹å‰çš„ã€‚

ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç•Œé¢æ›´æ–°æ˜¯äº‹ä»¶å¾ªç¯çš„æœ€åä¸€æ­¥ï¼Œæ‰€ä»¥æ— è®ºå‰é¢æ‰§è¡Œäº†å¤šå°‘æ¬¡ scrollTo ï¼Œæœ€ååªä¼šçœ‹åˆ°ä¸€æ¬¡æ»šåŠ¨æ›´æ–°

### åœ¨ setTimeout å’Œ rAF é‡Œå†æ¬¡æ‰§è¡Œçš„å¼‚åŒç‚¹

```js
window.scrollTo(0,50) 
window.setTimeout(()=>{
    window.scrollTo(0,150) 
},0)

// è¾“å‡ºä¸¤æ¬¡ scroll
```

ç›¸åŒç‚¹å¾ˆç®€å•ï¼Œå°±æ˜¯éƒ½æ˜¯ä¼šå†æ¬¡è§¦å‘ scroll äº‹ä»¶

ä¸åŒç‚¹åˆ™æ˜¯ï¼Œç”±äº setTimeout æ˜¯å¦ä¸€æ¬¡çš„äº‹ä»¶æ¸²æŸ“ï¼Œæ‰€ä»¥ç•Œé¢ä¸Šååº”çš„æ»šåŠ¨æ›´æ–°ä¼šæœ‰ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯æŠ–ä¸€ä¸‹ç„¶ååç§»åˆ° 150 ä½ç½®ã€‚ 

### è¯´è¯´ scrollTo å’Œ scrollBy

åŒºåˆ«å¾ˆç®€å•ï¼Œä¸€ä¸ªæ˜¯ç»å¯¹ä½ç½®æ»šåŠ¨ï¼Œä¸€ä¸ªç›¸å¯¹ä½ç½®æ»šåŠ¨ï¼Œæ›´å¤šè¯¦è§ [csswg](https://drafts.csswg.org/cssom-view/#dom-window-scroll)

ç„¶åè§¦å‘ scroll äº‹ä»¶çš„æ—¶æœºï¼Œå’Œä¸Šé¢çš„ä¸€æ ·ã€‚

- å…ˆæ‰§è¡Œ scrollTo(x1) å†æ‰§è¡Œ scrollBy(x2) æœ€ç»ˆä½ç½®ä¸º `x1+x2`
- å…ˆæ‰§è¡Œ scrollBy(x1) å†æ‰§è¡Œ scrollTo(x2) æœ€ç»ˆä½ç½®ä¸º `x2`

### Chrome 84 å†…éƒ¨æ»šåŠ¨çš„æ—¶æœºæ˜¯ä»€ä¹ˆæ—¶å€™

æ¯æ¬¡è°ƒæ•´å…ƒç´ çš„ scrollTop è¾“å‡ºç»“æœæ˜¯å¯ä»¥å®æ—¶ååº”çš„ï¼Œå› æ­¤æˆ‘ä»¬å†™å‡ºä»¥ä¸‹ä»£ç 

```js
function getScrollTop(){
    return document.documentElement.scrollTop || document.body.scrollTop
}
function showMore() {
    let items = document.querySelector('.items')
    let tmp = document.createElement('div')
    const lastScrollTop = getScrollTop()
    console.log("lastScrollTop:",lastScrollTop) // 529
    tmp.className = "item"
    tmp.style = `background-color: ${genRandomColor()}`;
    items.appendChild(tmp)
    console.log("currentScrollTop:",getScrollTop()) // 639
    window.scrollTo(0,lastScrollTop) 
    console.log("changeScrollTop:",getScrollTop()) // 529
}
```

å¯ä»¥å‘ç°ï¼Œåœ¨åˆ—è¡¨å®¹å™¨ appendChild å…ƒç´ ä¹‹æ—¶ï¼Œæµè§ˆå™¨å†…éƒ¨è°ƒç”¨äº†ç±»ä¼¼ scrollTo çš„æ–¹æ³•å»å˜æ›´åç§»é‡ã€‚ç”±äºæœ€åæˆ‘ä»¬è¿˜åŸäº† scrollTop ï¼Œæ‰€ä»¥æœ¬æ¬¡æµè§ˆå™¨å†…éƒ¨çš„è°ƒæ•´å°†ä¸ä¼šå½±å“åˆ°ã€‚

é—®é¢˜1å¾—åˆ°äº†è§£ç­”~ğŸ˜

## react åº”ç”¨ä¸­çš„å¤„ç† 

ä¸Šé¢è¯´çš„éƒ½æ˜¯åŸç”Ÿä»£ç çš„å†™æ³•ï¼Œé‚£ä¹ˆ react ä»£ç é‡Œåº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

å°†ä¸Šé¢çš„ä»£ç æ”¹é€ æˆ react ç»„ä»¶

```js
import React, { useState } from "react";
import "./styles.css";

function genRandomColor() {
  const fn = () => parseInt(Math.random() * (255 + 1), 10);
  return `rgb(${fn()},${fn()},${fn()})`;
}
const Item = ({ item }) => {
  return <div className="item" style={{ backgroundColor: item.color }} />;
};
const getScrollTop = () => {
  return document.documentElement.scrollTop || document.body.scrollTop;
};
const fetch = async () => {
  return new Promise(resolve => {
    setTimeout(() => {
      resolve({
        color: genRandomColor()
      });
    }, 0);
  });
};
export default function List() {
  const [list, setList] = useState(
    new Array(6).fill().map(v => ({ color: "red" }))
  );
  const showMore = async () => {
    const scrollTop = getScrollTop();
    let data = await fetch(); // åŒ…è£…äº† promise ï¼Œå…¶åçš„ä»£ç éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„
    // å¼‚æ­¥æ‰§è¡Œçš„ state å˜æ›´ï¼Œä¼šåŒæ­¥æ‰§è¡Œ useLayoutEffect å’Œ re-render
    setList([...list, data]);
    // åç§»é‡ç½®
    window.scrollTo({
      top: scrollTop
    });
  };
  return (
    <div className="container">
      <div className="items">
        {list.map((item, i) => (
          <Item item={item} key={i} />
        ))}
      </div>
      <button className="btn" onClick={showMore}>
        ç‚¹å‡»å±•å¼€æ›´å¤š
      </button>
    </div>
  );
}

```

> å¼‚æ­¥æ‰§è¡Œçš„ state å˜æ›´ï¼Œä¼šåŒæ­¥æ‰§è¡Œ useLayoutEffect å’Œ re-renderï¼šè¿™å¥è¯è¯´çš„æ˜¯ï¼Œåœ¨ promise æˆ– å®šæ—¶å™¨ç­‰ä¸å— react æ§åˆ¶çš„å¼‚æ­¥ä»£ç ä¸­ï¼Œæ‰§è¡ŒçŠ¶æ€å˜æ›´æ–¹æ³•ä¹‹åï¼Œå†…éƒ¨ç›´æ¥è¿›è¡Œ diff å¹¶é‡æ–° renderï¼Œå¹¶ä¸ä¼šç­‰åˆ°æ‰€æœ‰çŠ¶æ€å˜æ›´æ–¹æ³•æ‰§è¡Œä¹‹åæ‰æ›´æ–°ã€‚

<details>
<summary>æ›´å¤šç›¸å…³ä¾‹å­</summary>

```js
  useLayoutEffect(() => {
    console.log("useLayoutEffect");
  });
  const showMore = async () => {
    setLoading(true);
    console.log(0); // output: 0
    // åœ¨å¼‚æ­¥ç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œå¤„ç†äº†çŠ¶æ€å˜æ›´
    // output: useLayoutEffect
    let data = await fetch();
    console.log(1); // output:1
    setList([...list, data]); // output: useLayoutEffect
    console.log(2); // output:2
    setLoading(false); // output: useLayoutEffect
    console.log(3); // output:3
  };
```

å…·ä½“è¾“å‡ºçš„æ˜¯ï¼š
```
0
useLayoutEffect 
1
useLayoutEffect 
2
useLayoutEffect 
3
```
</details>


å¯¹äºåŒæ­¥å‡½æ•°æ¥è¯´ï¼Œ`setList` æ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ä¸èƒ½é©¬ä¸Šè¿›è¡Œ `window.scrollTo`

```js
const showMore = () => {
    const scrollTop = getScrollTop();
    let data = { color: genRandomColor() };
    setList([...list, data]);
    // æ— æ•ˆ
    window.scrollTo({
        top: scrollTop
    });
};
```

æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªèƒ½åŒæ—¶æ”¯æŒå¼‚æ­¥æ›´æ–°å’ŒåŒæ­¥æ›´æ–°çš„æ–¹æ³•ï¼Œå°è£…æˆ react hook ä»¥ä¾›å¤ç”¨

```js
function useScrollReset() {
  const lastScrollTopRef = useRef(0);
  const [scrollTop, setScrollTop] = useState(0);
  useLayoutEffect(() => {
    console.log("async: chromium v84+ need reset scroller");
    window.scrollTo({
      top: scrollTop
    });
  }, [scrollTop]);
  const remainLastScrollTop = useCallback(() => {
    lastScrollTopRef.current = getScrollTop();
  }, []);

  const resetScroller = useCallback(isAsyncStateChange => {
    if (isAsyncStateChange) {
      // é€‚åˆå¼‚æ­¥å˜æ›´çŠ¶æ€çš„åœºæ™¯
      setScrollTop(lastScrollTopRef.current);
    } else {
      // é€‚åˆåŒæ­¥å˜æ›´çŠ¶æ€çš„åœºæ™¯
      console.log("sync: chromium v84+ need reset scroller");
      window.scrollTo({
        top: lastScrollTopRef.current
      });
    }
  }, []);

  return [remainLastScrollTop, resetScroller];
}
```

å¯¼å‡º2ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³• `remainLastScrollTop` åœ¨åˆ—è¡¨å¡«å……æ•°æ®é¡¹å‰ä½¿ç”¨ï¼Œç”¨æ¥è®°ä½å½“å‰æ»šåŠ¨ä½ç½®ã€‚ç¬¬äºŒä¸ªæ–¹æ³•æ ¹æ®æ•°æ®çŠ¶æ€å˜æ›´æ˜¯å¦å¼‚æ­¥ï¼Œä¼ å…¥ç›¸åº”çš„å¸ƒå°”å€¼è¿›è¡Œå¤„ç†ã€‚

æ¯”å¦‚ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­ï¼Œåº”è¯¥è¿™ä¹ˆä½¿ç”¨

```js
  const showMore = async () => {
    let data = await fetch();
    remainLastScrollTop();
    // çŠ¶æ€æ˜¯åŒæ­¥å˜æ›´çš„ï¼Œæ‰§è¡Œåå·²é‡æ–° render
    setList([...list, data]);
    // æ•…è¿™é‡Œè®¾ç½® false å»ç›´æ¥è°ƒæ•´è¿›åº¦æ¡
    resetScroller(false);
  };

  const showMore = () => {
    let data = { color: genRandomColor() };
    remainLastScrollTop();
    // çŠ¶æ€æ˜¯å¼‚æ­¥å˜æ›´çš„ï¼Œæ‰€ä»¥è°ƒæ•´è¿›åº¦æ¡éœ€è¦ç­‰åˆ° useLayoutEffect ä¸­è¿›è¡Œ
    setList([...list, data]);
    // æ•…è¿™é‡Œè®¾ç½® true å»å˜æ›´ scroll state ä½¿å¾—ä¹‹åä¼šæ‰§è¡Œ useLayoutEffect
    resetScroller(true);
  };
```

[åœ¨çº¿demo](https://codesandbox.io/s/fix-load-more-scroll-cxzfu)


### åŠ ä¸Šæµè§ˆå™¨åˆ¤æ–­

ä¸€å¼€å§‹çš„æƒ³æ³•æ˜¯ï¼Œæ‹…å¿ƒå…¶ä»–æµè§ˆå™¨ä¼šå› ä¸ºã€Œæµè§ˆå™¨åç§»é‡ç½®ã€å¤šè€—è´¹äº†æ€§èƒ½ï¼Œäºæ˜¯åŠ äº†ä»¥ä¸‹åˆ¤æ–­


```js
import Bowser from 'bowser'
const browserInfo = Bowser.getParser(window.navigator.userAgent)
const needReset = browserInfo.satisfies({
    chrome: '>=84'
})
function useScrollReset() {
  const lastScrollTopRef = useRef(0);
  const [scrollTop, setScrollTop] = useState(0);
  useLayoutEffect(() => {
    console.log("async: chromium v84+ need reset scroller");
    window.scrollTo({
      top: scrollTop
    });
  }, [scrollTop]);
  const remainLastScrollTop = useCallback(() => {
    lastScrollTopRef.current = getScrollTop();
  }, []);

  const resetScroller = useCallback(isAsyncStateChange => {
    if (isAsyncStateChange) {
      // é€‚åˆå¼‚æ­¥å˜æ›´çŠ¶æ€çš„åœºæ™¯
      setScrollTop(lastScrollTopRef.current);
    } else {
      // é€‚åˆåŒæ­¥å˜æ›´çŠ¶æ€çš„åœºæ™¯
      console.log("sync: chromium v84+ need reset scroller");
      window.scrollTo({
        top: lastScrollTopRef.current
      });
    }
  }, []);

  return [remainLastScrollTop, needReset?resetScroller:()=>{}];
}
```

åæ¥æƒ³æƒ³ä¹Ÿæ²¡å¤ªå¿…è¦ï¼Œè€Œä¸”è¿™æ ·å¯ç»´æŠ¤æ€§å¾ˆå·®ï¼Œè¦æ˜¯åé¢å›½äº§æµè§ˆå™¨æ”¯æŒä¸Šäº† chromium ï¼Œè¿™é‡Œå¯èƒ½è¿˜å¾—æ”¹ï¼Œè€Œä¸”ä¸Šé¢è¿™ä¸ªè¿˜æ²¡åŠ ä¸Š Edgeï¼Œäºæ˜¯å°±å»æ‰äº†ã€‚

## ä» Ant Design List load more demo é‡Œå‘ç°çš„æ–°è§£æ³•

åœ¨æ‰¾åˆ°è§£æ³•çš„æ—¶å€™ï¼Œæƒ³ç€è¯´è¿™äº›ç»„ä»¶åº“æ˜¯ä¸æ˜¯è¿™æ¬¡æ›´æ–°çš„å¤„ç†ï¼Œæ²¡æœ‰çš„è¯æ˜¯ä¸æ˜¯å¯ä»¥ pr ä¸€æ³¢

äºæ˜¯æˆ‘æ‰“å¼€äº† and design ç»„ä»¶æ–‡æ¡£ï¼Œä½“éªŒäº†ä¸‹ List load more çš„ [demo](https://codesandbox.io/s/gk0jc)

ä»¤äººæƒŠå–œçš„æ˜¯ï¼Œè¿™ä¸ª demo å±…ç„¶å¯ä»¥æ­£å¸¸çš„ã€Œç‚¹å‡»åŠ è½½æ›´å¤šã€

éš¾é“å®˜æ–¹å›¢é˜Ÿæ—©å°±å‘ç°è¿™ä¸ªé—®é¢˜å¹¶ä¿®å¤äº†ï¼Ÿ

åœ¨çœ‹äº†ç›¸å…³ç»„ä»¶çš„æäº¤æ—¥å¿—å’Œæºç åï¼Œæˆ‘å¦å®šäº†è¿™ç§æƒ³æ³•ï¼Œç¡®å®šé—®é¢˜å‡ºåœ¨äº†è¿™ä¸ª demo ä¸Š
```js
import React from 'react';
import ReactDOM from 'react-dom';
import 'antd/dist/antd.css';
import './index.css';
import { List, Avatar, Button, Skeleton } from 'antd';

import reqwest from 'reqwest';

const count = 3;
const fakeDataUrl = `https://randomuser.me/api/?results=${count}&inc=name,gender,email,nat&noinfo`;

class LoadMoreList extends React.Component {
  state = {
    initLoading: true,
    loading: false,
    data: [],
    list: [],
  };

  componentDidMount() {
    this.getData(res => {
      this.setState({
        initLoading: false,
        data: res.results,
        list: res.results,
      });
    });
  }

  getData = callback => {
    reqwest({
      url: fakeDataUrl,
      type: 'json',
      method: 'get',
      contentType: 'application/json',
      success: res => {
        callback(res);
      },
    });
  };

  onLoadMore = () => {
    this.setState({
      loading: true,
      list: this.state.data.concat([...new Array(count)].map(() => ({ loading: true, name: {} }))),
    });
    this.getData(res => {
      const data = this.state.data.concat(res.results);
      this.setState(
        {
          data,
          list: data,
          loading: false,
        },
        () => {
          // Resetting window's offsetTop so as to display react-virtualized demo underfloor.
          // In real scene, you can using public method of react-virtualized:
          // https://stackoverflow.com/questions/46700726/how-to-use-public-method-updateposition-of-react-virtualized
          window.dispatchEvent(new Event('resize'));
        },
      );
    });
  };

  render() {
    const { initLoading, loading, list } = this.state;
    const loadMore =
      !initLoading && !loading ? (
        <div
          style={{
            textAlign: 'center',
            marginTop: 12,
            height: 32,
            lineHeight: '32px',
          }}
        >
          <Button onClick={this.onLoadMore}>loading more</Button>
        </div>
      ) : null;

    return (
      <List
        className="demo-loadmore-list"
        loading={initLoading}
        itemLayout="horizontal"
        loadMore={loadMore}
        dataSource={list}
        renderItem={item => (
          <List.Item
            actions={[<a key="list-loadmore-edit">edit</a>, <a key="list-loadmore-more">more</a>]}
          >
            <Skeleton avatar title={false} loading={item.loading} active>
              <List.Item.Meta
                avatar={
                  <Avatar src="https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png" />
                }
                title={<a href="https://ant.design">{item.name.last}</a>}
                description="Ant Design, a design language for background applications, is refined by Ant UED Team"
              />
              <div>content</div>
            </Skeleton>
          </List.Item>
        )}
      />
    );
  }
}

ReactDOM.render(<LoadMoreList />, document.getElementById('container'));
```

å¯ä»¥å‘ç°ï¼Œåœ¨åŠ è½½æ•°æ®æ—¶ï¼Œä¼šç§»é™¤æŒ‰é’®ï¼Œå› ä¸ºæœ¬èº«ç”¨äº†ä¸€äº› loading å ä½é¡¹ï¼Œæ‰€ä»¥ç§»é™¤æŒ‰é’®å¹¶ä¸ä¼šè®©å¸ƒå±€çœ‹èµ·æ¥æœ‰è¾ƒå¤§çš„æŠ–åŠ¨

æˆ‘ä»¬ç¨å¾®æ”¹åŠ¨ä¸‹ä»£ç ï¼Œç²¾ç®€å¦‚ä¸‹ï¼š
```js
import React from 'react';
import ReactDOM from 'react-dom';
import 'antd/dist/antd.css';
import './index.css';
import { List, Avatar, Button, Skeleton } from 'antd';

import reqwest from 'reqwest';

const count = 3;
const fakeDataUrl = `https://randomuser.me/api/?results=${count}&inc=name,gender,email,nat&noinfo`;

class LoadMoreList extends React.Component {
  state = {
    loading: false,
    data: [],
    list: [],
  };

  componentDidMount() {
    this.getData(res => {
      this.setState({
        data: res.results,
        list: res.results,
      });
    });
  }

  getData = callback => {
    reqwest({
      url: fakeDataUrl,
      type: 'json',
      method: 'get',
      contentType: 'application/json',
      success: res => {
        callback(res);
      },
    });
  };

  onLoadMore = () => {
    this.setState({
      loading: true
    });
    this.getData(res => {
      const data = this.state.data.concat(res.results);
      this.setState(
        {
          data,
          list: data,
          loading: false,
        }
      );
    });
  };

  render() {
    const { loading, list } = this.state;
    const loadMore =
      !loading ? (
        <div
          style={{
            textAlign: 'center',
            marginTop: 12,
            height: 32,
            lineHeight: '32px',
          }}
        >
          <Button onClick={this.onLoadMore}>loading more</Button>
        </div>
      ) : null;

    return (
      <>
      <List
        className="demo-loadmore-list"
        itemLayout="horizontal"
        dataSource={list}
        renderItem={item => (
          <List.Item
            actions={[<a key="list-loadmore-edit">edit</a>, <a key="list-loadmore-more">more</a>]}
          >
            <Skeleton avatar title={false} loading={item.loading} active>
              <List.Item.Meta
                avatar={
                  <Avatar src="https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png" />
                }
                title={<a href="https://ant.design">{item.name.last}</a>}
                description="Ant Design, a design language for background applications, is refined by Ant UED Team"
              />
              <div>content</div>
            </Skeleton>
          </List.Item>
        )}
      />
      {loadMore}
      </>
    );
  }
}

ReactDOM.render(<LoadMoreList />, document.getElementById('container'));
```

ç‚¹å‡»ä¹‹åï¼Œå»é™¤äº†æŒ‰é’®ï¼Œæ‰€ä»¥åˆ—è¡¨å±…åº•ï¼Œå¡«å……åˆ—è¡¨å¹¶å±•ç¤ºæŒ‰é’®åï¼Œåˆ—è¡¨å›åˆ°äº†åŸæ¥çš„ä½ç½®ã€‚

å¹¶ä¸”ï¼Œåœ¨å»é™¤äº† loading è¿™ä¸ªçŠ¶æ€åï¼Œå³
```js
const loadMore = <div
    style={{
      textAlign: 'center',
      marginTop: 12,
      height: 32,
      lineHeight: '32px',
    }}
  >
    <Button onClick={this.onLoadMore}>loading more</Button>
  </div>;
```

ç‚¹å‡»åŠ è½½æ›´å¤šçš„ bug å¤ç°äº†,è€Œä¸”ç”±äºåˆ é™¤æŒ‰é’®è¿˜å‡ºç°äº†æ–°çš„åç§»æŠ–åŠ¨ã€‚ã€‚

![](https://sf1-dycdn-tos.pstatp.com/obj/eden-cn/nupohneh7nupehpqnulog/img/loadmore_antd.gif)

ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼š

**å¦‚æœåˆ—è¡¨ä¸‹æ–¹æ²¡æœ‰å…ƒç´ (ç§»é™¤æˆ– display none éƒ½è¡Œï¼Œåªè¦ä¸å ä½ç½®)ï¼Œæµè§ˆå™¨å°†ä¸ä¼šè‡ªè¡Œè°ƒæ•´ä¸Šæ–¹å†…å®¹çš„æ»šåŠ¨åç§»å€¼**
> æ›´ç¡®åˆ‡çš„è¯´ï¼Œæ˜¯ã€Œè§¦å‘ç‚¹å‡»ç­‰äº‹ä»¶çš„é‚£ä¸ªå…ƒç´ ç›´è‡³ä¸åˆ—è¡¨å®¹å™¨å¹³çº§çš„ä¸Šçº§å…ƒç´ ã€éƒ½è¦è¢«å»é™¤ï¼Œå…¶ä»–ã€Œå¹³çº§çš„ä¸‹æ–¹å…ƒç´ ã€ä¸éœ€è¦å¤„ç†

æ‰€ä»¥ï¼Œåªè¦åœ¨åŠ è½½çš„æ—¶å€™å°†æŒ‰é’®éšè—ï¼ŒåŠ è½½åå†æ˜¾ç¤ºå›æ¥ã€‚ä½†æ˜¯éšè—æŒ‰é’®ä¼šæ”¹åŠ¨å¸ƒå±€ï¼Œå¦‚æœæ²¡æœ‰ loading item å ä½çš„è¯ï¼Œæ•°æ®åˆ—è¡¨ä¸€å¼€å§‹ä¼šå‘ä¸‹æ»šï¼Œä¹Ÿæ˜¯æŒºå½±å“ä½“éªŒçš„ã€‚


ç»¼åˆäº†ä¸‹ï¼Œæƒ³åˆ°ä¸€ä¸ªéªšæ“ä½œï¼šåœ¨æ‹¿åˆ°æ•°æ®åï¼Œappend åˆ°åˆ—è¡¨çš„åŒæ—¶éšè—æŒ‰é’®ï¼Œåœ¨å¡«å……ä¹‹åç«‹åˆ»æ˜¾ç¤ºå®ƒã€‚æ¬ºéª—æµè§ˆå™¨ï¼Œè®©å…¶åœ¨æ¸²æŸ“ä¹‹æ—¶å½“æ— äº‹å‘ç”Ÿã€‚

åŸç”Ÿä»£ç å¦‚ä¸‹ï¼š

```js
// ä¸‰å¤„ getScrollTop() å€¼å‡ä¸€è‡´
function showMore() {
    let items = document.querySelector('.items')
    let btn = document.querySelector('.btn')
    let tmp = document.createElement('div')
    const lastScrollTop = getScrollTop()
    console.log("lastScrollTop:",lastScrollTop)
    tmp.className = "item"
    tmp.style = `background-color: ${genRandomColor()}`;
    // å…ˆè¿›è¡Œéšè—
    btn.style.display = "none";
    items.appendChild(tmp)
    console.log("currentScrollTop:",getScrollTop())
    // é‡æ–°æ˜¾ç¤º
    btn.style.display = "block";
    console.log("changeScrollTop:",getScrollTop())
}
```

react é‡Œçš„å†™æ³•ï¼š

```js
export default function List() {
  const [loading, setLoading] = useState(false);
  const [list, setList] = useState(
    new Array(6).fill().map(v => ({ color: "red" }))
  );
  useLayoutEffect(() => {
    console.log("useLayoutEffect");
  });
  const showMore = async () => {
    let data = await fetch();
    // æ¯æ¬¡è®¾ç½®çŠ¶æ€éƒ½ä¼š re-render
    setLoading(true);
    setList([...list, data]);
    setLoading(false);
  };
  return (
    <div className="container">
      <div className="items">
        {list.map((item, i) => (
          <Item item={item} key={i} />
        ))}
      </div>
      {!loading && (
        <button className="btn" onClick={showMore}>
          ç‚¹å‡»å±•å¼€æ›´å¤š
        </button>
      )}
    </div>
  );
}
```


## æ€ä¹ˆæ¨¡æ‹Ÿ Chrome v84 è¿™ç§å›ºå®šè§†åŒºçš„æ•ˆæœ

è¿™ç§æ•ˆæœæœ‰ç‚¹åƒç§»åŠ¨ç«¯çš„ä¸‹æ‹‰åˆ·æ–°åœºæ™¯ï¼Œæ‰€ä»¥æˆ‘çŒœè¿™ä¸ªæ›´æ–°å¯èƒ½æ˜¯ä¸ºç§»åŠ¨ç«¯å‡†å¤‡çš„ã€‚

é‚£ä¹ˆè¯è¯´å›æ¥ï¼Œå…¶ä»–æµè§ˆå™¨è¦æ€ä¹ˆæ¨¡æ‹Ÿè¿™ä¸ªåŠŸèƒ½å‘¢ï¼Ÿ

å¯ä»¥æƒ³åˆ°çš„åšæ³•æœ‰ï¼š
1. ä½¿ç”¨ MutationObserver ç›‘å¬ DOM å˜æ›´ï¼ˆæ–°å¢å…ƒç´ ï¼‰ï¼Œè®¡ç®—å‰å offsetHeight çš„å·®å€¼ï¼Œä½¿ç”¨ scrollBy è¿›è¡Œæ»šåŠ¨åç§»
2. ç‚¹å‡»å‰åè®°å½•æŒ‰é’®çš„ offsetTop ï¼Œå…¶åè®¡ç®—å·®å€¼å¹¶ä½¿ç”¨ scrollBy è¿›è¡Œæ»šåŠ¨åç§»


ç¬¬äºŒç§åšæ³• demo å¦‚ä¸‹

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .container {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .items {
            width: 100%;
        }

        .item {
            margin-top: 10px;
            height: 100px;
            width: 100%;
            background-color: #FF142B;
        }

        .btn {
            width: 200px;
            height: 44px;
            margin-bottom: 40px;
            background: #BCCFFF;
            box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.05);
            border: none;
            border-radius: 22px;
            font-size: 15px;
            font-weight: 500;
            color: #FF142B;
            -webkit-transition: 150ms all;
            transition: 150ms all;
        }

        .bottom {
            width: 100%;
            height: 1200px;
        }
    </style>
    <script>
        function genRandomColor() {
            const fn = () => parseInt(Math.random() * (255 + 1), 10)
            return `rgb(${fn()},${fn()},${fn()})`
        }
        function getScrollTop() {
            return document.documentElement.scrollTop || document.body.scrollTop
        }
        function showMore() {
            let items = document.querySelector('.items')
            let btn = document.querySelector('.btn')
            let tmp = document.createElement('div')
            const lastOffsetTop = btn.offsetTop
            console.log("lastOffsetTop:", lastOffsetTop)
            tmp.className = "item"
            tmp.style = `background-color: ${genRandomColor()}`;
            items.appendChild(tmp)
            // æ”¾åœ¨ rAF ä¸­å¤„ç†ï¼Œé˜²æ­¢è¯»å– offsetTop ä¼šé€ æˆå›æµï¼Œæµè§ˆå™¨ç«‹åˆ»æ¸²æŸ“äº† items ï¼Œå…¶åè°ƒæ•´ scroll ä¼šé€ æˆé¡µé¢é—ªåŠ¨
            requestAnimationFrame(() => {
                const currentOffsetTop = btn.offsetTop
                console.log("currentOffsetTop:", currentOffsetTop)
                window.scrollBy({
                    top: currentOffsetTop - lastOffsetTop
                })
            })
        }
        function showMoreWithTimeout() {
            setTimeout(showMore, 10)
        }
    </script>
</head>

<body>
    <div class="container">
        <div class="items">
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </div>

    </div>
    <button class="btn" onclick="showMore()">ç‚¹å‡»å±•å¼€æ›´å¤š</button>
    <div class="bottom">
        å›ºå®šè§†åŒº
    </div>
</body>

</html>
```

æ³¨æ„è¿™é‡Œä¸ºäº†é˜²æ­¢å›æµé‡ç»˜ï¼Œæ”¾åœ¨äº† rAF ä¸­å¤„ç†

å¦‚æœæœ‰å…¶ä»–æ›´å¥½çš„åšæ³•ï¼Œæ¬¢è¿è¯„è®ºåˆ†äº«~

## æ€»ç»“

chrome v84+ çš„æµè§ˆå™¨å…·ä½“å›ºå®šè§†åŒºçš„æ–°ç‰¹æ€§ï¼Œä½†åŒæ—¶é€ æˆäº†ã€Œç‚¹å‡»åŠ è½½æ›´å¤šã€è¿™ç§åœºæ™¯å°†ä¸ç¬¦åˆé¢„æœŸã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œåˆ†åˆ«æ˜¯ï¼š
1. æ»šåŠ¨åç§»é‡ç½®
2. éšè—ä¸‹æ–¹å…ƒç´ 

ä¸¤ç§å‡èƒ½æ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯ï¼Œä¸è¿‡ä¹Ÿæœ‰å„è‡ªçš„é™åˆ¶ï¼š
- ç¬¬ä¸€ç§ä¼šé‡ç½®æ»šåŠ¨æ¡ï¼Œæ‰€ä»¥å¦‚æœç‚¹å‡»æŒ‰é’®åï¼Œåœ¨åˆ—è¡¨æœªå¡«å……æ—¶ï¼Œç”¨æˆ·ç»§ç»­å‘ä¸‹æ»šåŠ¨å¾ˆè¿œï¼›å¾…åˆ—è¡¨å¡«å……åï¼Œé‡ç½®äº†æ»šåŠ¨æ¡ï¼Œä½“éªŒä¹Ÿå¾ˆä¸å¥½
- ç¬¬äºŒç§çš„å¸ƒå±€æƒ…å†µè¿˜æ²¡å®Œå…¨ææ¸…ï¼Œæš‚ä¸æ¸…æ¥šä¼šä¸ä¼šæœ‰æŸç§å¸ƒå±€é™åˆ¶

å½“å‰ï¼Œæœ€å¥½è¿˜æ˜¯èƒ½çœ‹ä¸‹å†…æ ¸æºç æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Œä¹‹åä¼šæŒç»­å…³æ³¨è¯¥ [bug](https://bugs.chromium.org/p/chromium/issues/detail?id=1112040) çš„è¿›å±• ğŸ‘»
> ç›®å‰çŠ¶æ€ï¼šå·²è¢«å®˜æ–¹ç¡®è®¤

æœ€åï¼Œæˆ‘ä»¬å°è¯•è°ƒç ”äº†è¯¥ feature çš„å®ç°ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€


## åè®°

æ˜¾ç¤ºæ»šåŠ¨æ¡ç„ç‚¹è§„èŒƒï¼Œæ²¡å®ç°å¥½